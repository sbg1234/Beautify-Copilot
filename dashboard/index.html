<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Beautifi Autopilot | System Status</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,400&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #FAF9F7;
      --bg-card: #FFFFFF;
      --text-primary: #2C2C2C;
      --text-secondary: #6B6B6B;
      --text-muted: #9A9A9A;
      --accent-teal: #0D5C63;
      --accent-teal-light: #E8F4F5;
      --status-success: #4A7C59;
      --status-success-bg: #EDF5EF;
      --status-warning: #D4A574;
      --status-warning-bg: #FDF6EF;
      --status-error: #C7786A;
      --status-error-bg: #FAEFED;
      --status-idle: #7C8BA1;
      --status-idle-bg: #F0F2F5;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.04), 0 1px 2px rgba(0,0,0,0.06);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.04), 0 2px 4px rgba(0,0,0,0.06);
      --shadow-lg: 0 10px 25px rgba(0,0,0,0.06), 0 6px 10px rgba(0,0,0,0.04);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 20px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'DM Sans', -apple-system, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.25;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      z-index: 0;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 48px 24px;
      position: relative;
      z-index: 1;
    }

    /* Header */
    header {
      text-align: center;
      margin-bottom: 48px;
      animation: fadeInDown 0.6s ease-out;
    }

    .logo-section h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2.75rem;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: -0.02em;
      margin-bottom: 8px;
    }

    .logo-section .subtitle {
      font-size: 1rem;
      color: var(--text-secondary);
      font-weight: 400;
    }

    /* Status Hero */
    .status-hero {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 40px;
      box-shadow: var(--shadow-lg);
      text-align: center;
      margin-bottom: 32px;
      animation: fadeInUp 0.6s ease-out 0.1s backwards;
      position: relative;
      overflow: hidden;
    }

    .status-hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: linear-gradient(90deg, var(--status-success), #6BA574);
    }

    .status-hero.warning::before {
      background: linear-gradient(90deg, var(--status-warning), #E4B584);
    }

    .status-hero.error::before {
      background: linear-gradient(90deg, var(--status-error), #D7887A);
    }

    .status-indicator {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .status-dot {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--status-success);
      box-shadow: 0 0 0 4px var(--status-success-bg);
      animation: pulse 2s ease-in-out infinite;
    }

    .status-dot.warning {
      background: var(--status-warning);
      box-shadow: 0 0 0 4px var(--status-warning-bg);
    }

    .status-dot.error {
      background: var(--status-error);
      box-shadow: 0 0 0 4px var(--status-error-bg);
      animation: none;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.8; }
    }

    .status-label {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--status-success);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .status-label.warning { color: var(--status-warning); }
    .status-label.error { color: var(--status-error); }

    .status-title {
      font-family: 'Playfair Display', serif;
      font-size: 2rem;
      font-weight: 500;
      margin-bottom: 8px;
    }

    .status-description {
      color: var(--text-secondary);
      font-size: 0.95rem;
      max-width: 500px;
      margin: 0 auto;
    }

    /* Info Grid */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-bottom: 32px;
    }

    .info-card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 28px;
      box-shadow: var(--shadow-md);
      animation: fadeInUp 0.6s ease-out backwards;
    }

    .info-card:nth-child(1) { animation-delay: 0.15s; }
    .info-card:nth-child(2) { animation-delay: 0.2s; }
    .info-card:nth-child(3) { animation-delay: 0.25s; }

    .info-card-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .info-card-icon {
      width: 44px;
      height: 44px;
      border-radius: var(--radius-md);
      background: var(--accent-teal-light);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent-teal);
    }

    .info-card-title {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      font-weight: 500;
    }

    .info-card-value {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .info-card-subtext {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* Configuration Section */
    .config-section {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 32px;
      box-shadow: var(--shadow-md);
      margin-bottom: 32px;
      animation: fadeInUp 0.6s ease-out 0.3s backwards;
    }

    .section-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.4rem;
      font-weight: 500;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .config-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .config-item {
      padding: 20px;
      background: var(--bg-primary);
      border-radius: var(--radius-md);
      border: 1px solid rgba(0,0,0,0.04);
    }

    .config-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      margin-bottom: 8px;
      font-weight: 500;
    }

    .config-value {
      font-size: 0.95rem;
      color: var(--text-primary);
      word-break: break-all;
    }

    .config-value a {
      color: var(--accent-teal);
      text-decoration: none;
      font-weight: 500;
    }

    .config-value a:hover {
      text-decoration: underline;
    }

    .schedule-select {
      padding: 10px 14px;
      font-size: 0.95rem;
      font-family: 'DM Sans', sans-serif;
      border: 2px solid rgba(0,0,0,0.08);
      border-radius: var(--radius-sm);
      background: var(--bg-card);
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 180px;
    }

    .schedule-select:hover {
      border-color: var(--accent-teal);
    }

    .schedule-select:focus {
      outline: none;
      border-color: var(--accent-teal);
      box-shadow: 0 0 0 3px var(--accent-teal-light);
    }

    .config-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--status-success-bg);
      color: var(--status-success);
      border-radius: 50px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    /* Run Log Section */
    .run-log-section {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 32px;
      box-shadow: var(--shadow-md);
      animation: fadeInUp 0.6s ease-out 0.35s backwards;
    }

    .run-log-table {
      width: 100%;
      border-collapse: collapse;
    }

    .run-log-table th {
      text-align: left;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      font-weight: 500;
      padding: 12px 16px;
      border-bottom: 1px solid rgba(0,0,0,0.06);
    }

    .run-log-table td {
      padding: 16px;
      border-bottom: 1px solid rgba(0,0,0,0.04);
      font-size: 0.9rem;
    }

    .run-log-table tr:last-child td {
      border-bottom: none;
    }

    .run-log-table tr:hover {
      background: var(--bg-primary);
    }

    .run-status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 50px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .run-status.success {
      background: var(--status-success-bg);
      color: var(--status-success);
    }

    .run-status.failed {
      background: var(--status-error-bg);
      color: var(--status-error);
    }

    /* Links Section */
    .links-section {
      display: flex;
      gap: 16px;
      margin-top: 32px;
      animation: fadeInUp 0.6s ease-out 0.4s backwards;
    }

    .link-button {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 18px 24px;
      background: var(--bg-card);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      text-decoration: none;
      color: var(--text-primary);
      font-weight: 500;
      transition: all 0.2s ease;
    }

    .link-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
      background: var(--accent-teal);
      color: white;
    }

    .link-button svg {
      width: 20px;
      height: 20px;
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Responsive */
    @media (max-width: 900px) {
      .info-grid {
        grid-template-columns: 1fr;
      }

      .config-grid {
        grid-template-columns: 1fr;
      }

      .links-section {
        flex-direction: column;
      }
    }

    @media (max-width: 600px) {
      .container {
        padding: 24px 16px;
      }

      .logo-section h1 {
        font-size: 2rem;
      }

      .status-hero {
        padding: 28px 20px;
      }

      .status-title {
        font-size: 1.5rem;
      }

      .run-log-table {
        font-size: 0.8rem;
      }

      .run-log-table th,
      .run-log-table td {
        padding: 10px 8px;
      }
    }

    /* Empty state */
    .empty-state {
      text-align: center;
      padding: 40px;
      color: var(--text-muted);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo-section">
        <h1>Beautifi Autopilot</h1>
        <p class="subtitle">Financing Portal Monitor | System Status</p>
      </div>
    </header>

    <div class="status-hero" id="statusHero">
      <div class="status-indicator">
        <div class="status-dot" id="statusDot"></div>
        <span class="status-label" id="statusLabel">Operational</span>
      </div>
      <h2 class="status-title" id="statusTitle">System Running Normally</h2>
      <p class="status-description" id="statusDescription">
        The Beautifi portal watcher is active and monitoring for application changes.
        Notifications are being sent via Slack.
      </p>
    </div>

    <div class="info-grid">
      <div class="info-card">
        <div class="info-card-header">
          <div class="info-card-icon">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
          </div>
          <span class="info-card-title">Last Scrape</span>
        </div>
        <div class="info-card-value" id="lastScrape">—</div>
        <div class="info-card-subtext" id="lastScrapeAgo">Loading...</div>
      </div>

      <div class="info-card">
        <div class="info-card-header">
          <div class="info-card-icon">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
            </svg>
          </div>
          <span class="info-card-title">Applications Tracked</span>
        </div>
        <div class="info-card-value" id="appCount">—</div>
        <div class="info-card-subtext">Across 3 pipeline stages</div>
      </div>

      <div class="info-card">
        <div class="info-card-header">
          <div class="info-card-icon">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
          </div>
          <span class="info-card-title">Success Rate</span>
        </div>
        <div class="info-card-value" id="successRate">—</div>
        <div class="info-card-subtext" id="totalRuns">Loading...</div>
      </div>
    </div>

    <div class="config-section">
      <h3 class="section-title">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
        </svg>
        Configuration
      </h3>
      <div class="config-grid">
        <div class="config-item">
          <div class="config-label">Notification Channel</div>
          <div class="config-value">
            <span class="config-badge">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                <path d="M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z"/>
              </svg>
              Slack Connected
            </span>
          </div>
        </div>
        <div class="config-item">
          <div class="config-label">Schedule</div>
          <div class="config-value">
            <select class="schedule-select" id="scheduleSelect">
              <option value="15">Every 15 minutes</option>
              <option value="30" selected>Every 30 minutes</option>
              <option value="60">Every 60 minutes</option>
              <option value="90">Every 90 minutes</option>
              <option value="120">Every 2 hours</option>
              <option value="240">Every 4 hours</option>
              <option value="360">Every 6 hours</option>
            </select>
          </div>
        </div>
        <div class="config-item">
          <div class="config-label">Data Source</div>
          <div class="config-value">Beautifi Partner Portal (app.beautifi.com)</div>
        </div>
        <div class="config-item">
          <div class="config-label">Monitored Stages</div>
          <div class="config-value">In-Progress, Submitted, Accepted & Approved</div>
        </div>
      </div>
    </div>

    <div class="run-log-section">
      <h3 class="section-title">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
        </svg>
        Recent Run Log
      </h3>
      <table class="run-log-table">
        <thead>
          <tr>
            <th>Timestamp</th>
            <th>Status</th>
            <th>Duration</th>
            <th>Apps Found</th>
            <th>Changes</th>
            <th>New</th>
          </tr>
        </thead>
        <tbody id="runLogBody">
          <tr>
            <td colspan="6" class="empty-state">Loading run history...</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="links-section">
      <a href="https://docs.google.com/spreadsheets/d/1d9BGPguTvPRvfDJ-s2CjEv0eTROxodaAGIGZCivNGx0/edit" target="_blank" class="link-button">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
        </svg>
        Open Google Sheet
      </a>
      <a href="https://app.beautifi.com/partners/sign-in" target="_blank" class="link-button">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
          <polyline points="15 3 21 3 21 9"></polyline>
          <line x1="10" y1="14" x2="21" y2="3"></line>
        </svg>
        Beautifi Portal
      </a>
    </div>
  </div>

  <script>
    // Toronto timezone
    const TIMEZONE = 'America/Toronto';

    // Sample run log data (in production, this would come from Google Sheets API)
    // Timestamps are in ISO format with Toronto timezone consideration
    const runLog = [
      { timestamp: '2026-01-08T19:30:00-05:00', status: 'Success', duration: 28, appsFound: 21, changes: 0, newApps: 0 },
      { timestamp: '2026-01-08T19:00:00-05:00', status: 'Success', duration: 28, appsFound: 21, changes: 1, newApps: 1 },
      { timestamp: '2026-01-08T18:30:00-05:00', status: 'Success', duration: 40, appsFound: 21, changes: 21, newApps: 21 },
    ];

    function formatTimestamp(ts) {
      const date = new Date(ts);
      return date.toLocaleString('en-US', {
        timeZone: TIMEZONE,
        month: 'short',
        day: 'numeric',
        hour: 'numeric',
        minute: '2-digit',
        hour12: true
      });
    }

    function timeAgo(ts) {
      // Get current time in Toronto
      const now = new Date();
      const then = new Date(ts);
      const diffMs = now - then;
      const diffMins = Math.floor(diffMs / 60000);
      const diffHours = Math.floor(diffMins / 60);
      const diffDays = Math.floor(diffHours / 24);

      if (diffMins < 1) return 'Just now';
      if (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`;
      if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
      return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
    }

    // Schedule change handler (placeholder - would update Railway cron in production)
    function handleScheduleChange(event) {
      const minutes = event.target.value;
      console.log(`Schedule changed to: Every ${minutes} minutes`);
      // In production, this would call an API to update Railway cron schedule
      localStorage.setItem('beautifi-schedule', minutes);
    }

    function renderRunLog() {
      const tbody = document.getElementById('runLogBody');

      if (runLog.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" class="empty-state">No runs recorded yet</td></tr>';
        return;
      }

      tbody.innerHTML = runLog.map(run => `
        <tr>
          <td>${formatTimestamp(run.timestamp)}</td>
          <td><span class="run-status ${run.status.toLowerCase()}">${run.status}</span></td>
          <td>${run.duration}s</td>
          <td>${run.appsFound}</td>
          <td>${run.changes}</td>
          <td>${run.newApps}</td>
        </tr>
      `).join('');
    }

    function updateMetrics() {
      // Last scrape
      if (runLog.length > 0) {
        const lastRun = runLog[0];
        document.getElementById('lastScrape').textContent = formatTimestamp(lastRun.timestamp);
        document.getElementById('lastScrapeAgo').textContent = timeAgo(lastRun.timestamp);
        document.getElementById('appCount').textContent = lastRun.appsFound;

        // Success rate
        const successCount = runLog.filter(r => r.status === 'Success').length;
        const rate = Math.round((successCount / runLog.length) * 100);
        document.getElementById('successRate').textContent = rate + '%';
        document.getElementById('totalRuns').textContent = `${runLog.length} runs recorded`;

        // Update status based on last run
        if (lastRun.status !== 'Success') {
          document.getElementById('statusHero').classList.add('error');
          document.getElementById('statusDot').classList.add('error');
          document.getElementById('statusLabel').textContent = 'Error';
          document.getElementById('statusLabel').classList.add('error');
          document.getElementById('statusTitle').textContent = 'Last Run Failed';
          document.getElementById('statusDescription').textContent = 'The most recent scrape encountered an error. Check the run log for details.';
        }
      }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      renderRunLog();
      updateMetrics();

      // Set up schedule dropdown
      const scheduleSelect = document.getElementById('scheduleSelect');
      const savedSchedule = localStorage.getItem('beautifi-schedule');
      if (savedSchedule) {
        scheduleSelect.value = savedSchedule;
      }
      scheduleSelect.addEventListener('change', handleScheduleChange);
    });
  </script>
</body>
</html>
